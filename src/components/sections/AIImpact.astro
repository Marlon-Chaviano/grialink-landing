---
import Container from "@/components/ui/Container.astro";
import { type Lang } from "@/i18n/config";
import { getTranslations } from "@/i18n/utils";

interface Props {
	lang: Lang;
}

const { lang } = Astro.props;
const ai = getTranslations(lang, "aiImpact") as Record<string, any>;

const featureIcons = [
	"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z",
	"M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941",
	"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z",
	"M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25",
];

const featuresList = (ai.features ?? []) as Array<{ label: string; color: string; active: boolean }>;

const features = featuresList.map((f, i) => ({
	icon: featureIcons[i] ?? featureIcons[0],
	color: f.color,
	label: f.label,
	active: f.active,
}));

const colorClasses: Record<string, { bg: string; text: string }> = {
	pink: { bg: "bg-pink-500/20", text: "text-pink-500" },
	blue: { bg: "bg-blue-500/20", text: "text-blue-500" },
	teal: { bg: "bg-teal-500/20", text: "text-teal-500" },
	yellow: { bg: "bg-yellow-500/20", text: "text-yellow-500" },
};

const d = ai.dashboard as Record<string, string>;
---

<section class="section-spacing bg-background text-foreground overflow-hidden relative">
	<!-- Top glow -->
	<div
		class="absolute top-0 left-1/2 -translate-x-1/2 w-96 h-32 bg-linear-to-r from-primary via-purple-500 to-blue-500 blur-[100px] opacity-40"
		aria-hidden="true"
	>
	</div>

	<Container>
		<!-- Heading -->
		<div
			class="text-center mb-16 relative z-10"
			data-animate
		>
			<h2 class="text-3xl sm:text-4xl md:text-6xl font-bold tracking-tight mb-4">
				{ai.headingLine1}<br />
				<span class="text-transparent bg-clip-text bg-linear-to-r from-foreground to-muted-foreground">{ai.headingLine2}</span>
			</h2>
			<a
				class="inline-flex items-center text-muted-foreground hover:text-foreground mt-4 border-b border-border hover:border-foreground pb-1 transition-colors group"
				href={`/${lang}/products`}
			>
				{ai.exploreLink}
				<svg
					class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M17 8l4 4m0 0l-4 4m4-4H3"
					></path>
				</svg>
			</a>
		</div>

		<!-- Content -->
		<div
			class="flex flex-col lg:flex-row gap-12 items-center"
			data-animate
		>
			<!-- Feature list -->
			<div class="lg:w-1/3 space-y-4">
				{
					features.map((item) => {
						const colors = colorClasses[item.color];
						return (
							<div class="group">
								<div
									class:list={[
										"flex items-center gap-4 p-4 rounded-xl border transition-all duration-300",
										item.active ? "bg-secondary/50 border-border hover:border-primary/50" : "border-transparent hover:bg-secondary/30",
									]}
								>
									<div class:list={["w-10 h-10 rounded-full flex items-center justify-center shrink-0", colors.bg, colors.text]}>
										<svg
											class="w-5 h-5"
											fill="none"
											stroke="currentColor"
											viewBox="0 0 24 24"
										>
											<path
												stroke-linecap="round"
												stroke-linejoin="round"
												stroke-width="1.5"
												d={item.icon}
											/>
										</svg>
									</div>
									<span
										class:list={[
											"text-base lg:text-lg font-medium group-hover:text-foreground transition-colors",
											item.active ? "text-foreground" : "text-muted-foreground",
										]}
									>
										{item.label}
									</span>
								</div>
							</div>
						);
					})
				}
			</div>

			<!-- Dashboard mockup -->
			<div class="lg:w-2/3 w-full">
				<div class="bg-secondary border border-border rounded-2xl p-4 sm:p-6 shadow-2xl relative overflow-hidden">
					<!-- Window controls -->
					<div class="flex items-center justify-between mb-6 sm:mb-8">
						<div class="flex items-center gap-2">
							<div class="w-3 h-3 rounded-full bg-red-500"></div>
							<div class="w-3 h-3 rounded-full bg-yellow-500"></div>
							<div class="w-3 h-3 rounded-full bg-green-500"></div>
						</div>
						<div class="bg-surface px-3 py-1 rounded text-xs text-muted-foreground">{d.windowLabel}</div>
					</div>

					<!-- Charts -->
					<div class="grid grid-cols-3 gap-4 mb-6">
						<div class="col-span-2 bg-card p-4 rounded-lg">
							<div class="text-xs text-muted-foreground mb-2">{d.demandChart}</div>
							<div class="flex items-end gap-1 h-20">
								<div
									class="w-1/6 bg-surface rounded-t"
									style="height: 40%"
								>
								</div>
								<div
									class="w-1/6 bg-surface rounded-t"
									style="height: 60%"
								>
								</div>
								<div
									class="w-1/6 bg-primary rounded-t relative"
									style="height: 80%"
								>
									<div
										class="absolute -top-6 left-1/2 -translate-x-1/2 bg-foreground text-background text-[10px] px-1 py-0.5 rounded shadow whitespace-nowrap"
									>
										+24%
									</div>
								</div>
								<div
									class="w-1/6 bg-surface rounded-t"
									style="height: 50%"
								>
								</div>
								<div
									class="w-1/6 bg-surface rounded-t"
									style="height: 70%"
								>
								</div>
								<div
									class="w-1/6 bg-surface rounded-t"
									style="height: 45%"
								>
								</div>
							</div>
						</div>
						<div class="col-span-1 bg-card p-4 rounded-lg flex flex-col justify-between">
							<div class="text-xs text-muted-foreground">{d.noShowLabel}</div>
							<div class="text-2xl sm:text-3xl font-bold text-foreground">12%</div>
							<div class="text-[10px] text-green-400">{d.noShowDelta}</div>
						</div>
					</div>

					<!-- Alert -->
					<div class="bg-card p-4 rounded-lg border-l-4 border-destructive">
						<div class="flex flex-col sm:flex-row justify-between items-start gap-3">
							<div>
								<h4 class="text-sm font-semibold text-foreground mb-1">{d.alertTitle}</h4>
								<p class="text-xs text-muted-foreground">{d.alertDesc}</p>
							</div>
							<button
								class="bg-destructive/20 text-destructive px-3 py-1 rounded text-xs hover:bg-destructive hover:text-destructive-foreground transition-colors whitespace-nowrap cursor-pointer"
							>
								{d.alertBtn}
							</button>
						</div>
					</div>

					<!-- Suggestion popup -->
					<div
						class="absolute bottom-4 right-4 sm:bottom-6 sm:right-6 bg-surface border border-border p-3 sm:p-4 rounded-xl shadow-lg max-w-[200px] sm:max-w-xs"
					>
						<div class="flex items-center gap-2 mb-2">
							<svg
								class="w-4 h-4 text-primary"
								fill="currentColor"
								viewBox="0 0 24 24"
							>
								<path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"></path>
							</svg>
							<span class="text-xs font-bold text-foreground">{d.suggestionTitle}</span>
						</div>
						<p class="text-xs text-muted-foreground">{d.suggestionDesc}</p>
						<div class="flex gap-2 mt-3">
							<button
								class="flex-1 bg-primary text-primary-foreground text-xs py-1.5 rounded hover:bg-primary-hover transition-colors cursor-pointer"
							>
								{d.suggestionAccept}
							</button>
							<button
								class="flex-1 bg-surface text-muted-foreground text-xs py-1.5 rounded hover:bg-background-lighter transition-colors cursor-pointer"
							>
								{d.suggestionDismiss}
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</Container>
</section>
