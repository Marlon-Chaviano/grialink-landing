---
/**
 * ProductsGrid — Displays the 4 modular product cards.
 * Static Astro component — no client-side JS needed.
 */
import Container from "@/components/ui/Container.astro";
import { type Lang, localizedHref } from "@/i18n/config";
import { getTranslations } from "@/i18n/utils";
import { products, productColorClasses, productLinkHoverColor } from "@/lib/products";

interface Props {
	lang: Lang;
}

const { lang } = Astro.props;
const p = getTranslations(lang, "productsPage") as Record<string, any>;
const grid = p.grid as Record<string, string>;
const productTranslations = p.products as Record<string, { name: string; description: string }>;

/** Map product slugs to their actual section anchors */
const sectionAnchor: Record<string, string> = {
	prospector: "prospector",
	outreach: "coming-soon",
	ses: "ses",
	analytics: "coming-soon",
	"sales-dashboard": "sales-dashboard",
};
---

<section
	class="section-spacing bg-background-lighter relative"
	id="ecosystem"
>
	<Container>
		<!-- Section header -->
		<div
			class="mb-16 md:flex md:justify-between md:items-end"
			data-animate
		>
			<div class="max-w-xl">
				<h2 class="text-3xl sm:text-4xl font-bold text-foreground mb-4">
					{grid.title}
				</h2>
				<p class="text-lg text-muted-foreground">
					{grid.subtitle}
				</p>
			</div>
		</div>

		<!-- Cards grid -->
		<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
			{
				products.map((product) => {
					const t = productTranslations[product.id];
					const colors = productColorClasses[product.color];
					const linkColor = productLinkHoverColor[product.color];

					return (
						<a
							href={localizedHref(`/products#${sectionAnchor[product.slug] ?? product.slug}`, lang)}
							id={product.slug}
							class:list={[
								"group bg-card p-8 rounded-2xl border border-transparent transition-all duration-300",
								"hover:-translate-y-1 hover:shadow-lg hover:shadow-foreground/5",
								colors.border,
							]}
							data-animate
						>
							{/* Icon */}
							<div
								class:list={[
									"w-12 h-12 rounded-xl flex items-center justify-center mb-6 transition-colors duration-300",
									colors.bg,
									colors.text,
									colors.bgHover,
								]}
							>
								<svg
									class="w-6 h-6"
									fill="currentColor"
									viewBox="0 0 24 24"
								>
									<path d={product.iconPath} />
								</svg>
							</div>

							{/* Title */}
							<h3 class="text-xl font-bold text-foreground mb-3">{t.name}</h3>

							{/* Description */}
							<p class="text-muted-foreground text-sm leading-relaxed">{t.description}</p>

							{/* View details link */}
							<div class="mt-6 pt-6 border-t border-border-light">
								<span class:list={["flex items-center gap-2 text-xs font-semibold text-muted-foreground transition-colors", linkColor]}>
									{grid.viewDetails}
									<svg
										class="w-4 h-4 group-hover:translate-x-1 transition-transform"
										fill="none"
										stroke="currentColor"
										viewBox="0 0 24 24"
									>
										<path
											stroke-linecap="round"
											stroke-linejoin="round"
											stroke-width="2"
											d="M17 8l4 4m0 0l-4 4m4-4H3"
										/>
									</svg>
								</span>
							</div>
						</a>
					);
				})
			}
		</div>
	</Container>
</section>
